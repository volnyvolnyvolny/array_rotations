# Array rotations in Rust

This page citates [https://github.com/scandum/rotate](https://github.com/scandum/rotate).

## Quick Start

To build project with documentation:

```text
cargo build
cargo doc
```

To benchmark:

```text
cargo bench
```

Benchmarking could take some time :)

## Intoduction

A rotation is to swap the left side of an array with the right side:

```text
                  dim      mid
       left = 9   | bridge |    right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              shadow
```

after the rotation the data is as following:

```text
[10 11 12 13 14 15: 1  2  3* 4  5  6  7  8  9]
```

# Algorithms

## ğŸ’¾ Auxiliary rotation

â€œThis is an easy and fast way to rotate, but since it requires auxiliary memory
it is of little interest to in-place algorithms. Itâ€™s a good strategy for array
sizes of `1000` elements or less. The smaller half is copied to swap memory, the
larger half is moved, and the swap memory is copied back to the main array.â€[^1]

### Examples

```text
                   dim     mid
       left = 9    |       |        right = 6
[ 1  2  3  4  5  6 :7  8  9*            10-15]                 move
                                         â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
[              1-6 :7  .  9  âœ˜  âœ˜  âœ˜  âœ˜  âœ˜  âœ˜]    [10 .. 15]   move
               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ âœ˜  âœ˜  âœ˜  âœ˜  âœ˜  âœ˜ :1 ~~~~~~~~~~~~~~~~~~~~~ 9]    [10-15   ]   move
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”˜
[10 ~~~~~~~~~~~ 15 :1  .  3* 4  .  .  .  .  9]
```

```text
                                 mid
          left = 11              | right = 4
[ 1  2  3  4: 5  6  7  8  9 10 11*      12-15]                 move
                                         â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
[ 1  .  .  .  .  .  .  .  .  . 11  âœ˜  âœ˜  âœ˜  âœ˜]    [12 .. 15]   move
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ âœ˜  âœ˜  âœ˜  âœ˜  1 ~~~~~~~~~~~~~~~~~~~~~~~~~~ 11]    [12-15   ]   move
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”˜
[12 ~~~~~ 15: 1  .  .  .  .  .  7* 8  .  . 11]
```

```text
            mid
   left = 4 |          right = 11
[      12-15* 1  2  3  4  5  6  7: 8  9 10 11]                 move
        â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
[ âœ˜  âœ˜  âœ˜  âœ˜  1  .  .  .  .  .  .  .  .  . 11]    [12 .. 15]   move
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[ 1 ~~~~~~~~~~~~~~~~~~~~~~~~~~ 11  .  .  .  .]    [12-15   ]   move
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”˜
[ 1  .  .  4* 5  .  .  .  .  . 11:12 ~~~~~ 15]
```

## ğŸŒ‰ Bridge rotation

"This is a slightly more complex auxiliary rotation than
auxiliary rotation that reduces the maximum auxiliary memory
requirement from `50%` to `33.(3)%`. If the overlap between the
two halves is smaller than the halves themselves it copies
the overlap to swap memory instead. Its first known publication
was in *2021* by *Igor van den Hoven*."[^1]

### Examples

Here `bridge` is less than `left` || `right`.
Otherwise, algorithm fallbacks to *auxiliary*.

Case `left > right`:

```text
                  dim      mid
         left = 9 | ğ‘ğ‘Ÿğ‘–ğ‘‘ğ‘”ğ‘’   |   right = 6
[ 1  2  3  4  5  6: 7-9    *10 11 12 13 14 15]
                    â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
  a-->              b-->     c-->                  |     |
[ 1  .  .  .  .  6: âœ˜  âœ˜  âœ˜*10  .  .  .  . 15]    [7  8  9]
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”€â”€â”€â”€â”€â”€â”€â•¯
  â†“  a              â†“  b        c
[10  2  .  .  .  6  1  âœ˜  âœ˜  âœ˜ 11  .  .  . 15]    [7  .  9]
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
     â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”€â”€â”€â”€â”€â”€â”€â•¯
     â†“  a              â†“  b        c
[10 11  3  .  .  6  1  2  âœ˜  âœ˜  âœ˜ 12  .  . 15]    [7  .  9]
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
        â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”€â”€â”€â”€â”€â”€â”€â•¯
        â†“  a              â†“  b        c
[10  . 12  4  .  6  1  .  3  âœ˜  âœ˜  âœ˜ 13  . 15]    [7  .  9]
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
           â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”€â”€â”€â”€â”€â”€â”€â•¯
           â†“  a              â†“  b        c
[10  .  . 13  5  6  1  .  .  4  âœ˜  âœ˜  âœ˜ 14 15]    [7  .  9]
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
              â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”€â”€â”€â”€â”€â”€â”€â•¯
              â†“  a              â†“  b        c
[10  .  .  . 14  6  1  .  .  .  5  âœ˜  âœ˜  âœ˜ 15]    [7  .  9]
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
                 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”€â”€â”€â”€â”€â”€â”€â•¯
                 â†“                 â†“  b
[10 ~~~~~~~~~~~ 15  1 ~~~~~~~~~~~~ 6  âœ˜  âœ˜  âœ˜]    [7-9    ]
                                      â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”˜
[10  .  .  .  . 15: 1  .  3* 4  .  6  7 ~~~ 9]
```

Case `left < right`:

```text
                  mid      dim
      left = 6    | ğ‘ğ‘Ÿğ‘–ğ‘‘ğ‘”ğ‘’   |  right = 9
[10 11 12 13 14 15*     1-3: 4  5  6  7  8  9]
                        â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
                    b        c              d      |     |
[10  .  .  .  . 15* âœ˜  âœ˜  âœ˜: 4  .  .  .  .  9]    [1  2  3]
                 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®|
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”˜
                 b       câ†“                â†“d
[10  .  .  . 14  âœ˜  âœ˜  âœ˜  9  4  .  .  .  8 15]    [1  .  3]
              â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®|
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”˜
              b       câ†“                â†“d
[10  .  . 13  âœ˜  âœ˜  âœ˜  8  9  4  .  .  7 14 15]    [1  .  3]
           â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®|
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”˜
           b       câ†“                â†“d
[10  . 12  âœ˜  âœ˜  âœ˜  7  .  9  4  .  6 13  . 15]    [1  .  3]
        â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®|
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”˜
        b       câ†“                â†“d
[10 11  âœ˜  âœ˜  âœ˜  6  .  .  9  4  5 12  .  . 15]    [1  .  3]
     â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®|
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”˜
     b       câ†“                â†“d
[10  âœ˜  âœ˜  âœ˜  5  .  .  .  9  4 11  .  .  . 15]    [1  .  3]
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®|
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â”˜
          câ†“               dâ†“
[ âœ˜  âœ˜  âœ˜  4 ~~~~~~~~~~~~ 9 10 ~~~~~~~~~~~ 15]    [1-3    ]
  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”˜
[ 1 ~~~ 3  4  .  6* 7  .  9:10  .  .  .  . 15]
```

## ğŸ¤¹ Juggling rotation

"Also known as the dolphin algorithm. This is a relatively complex
and inefficient way to rotate in-place, though it does so in the
minimal number of moves. Its first known publication was in *1966*.
It computes the greatest common divisor and uses a loop to create
a chain of consecutive swaps."[^1]

### Example

```text
                           mid
          left = 9         |    right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]
  |        |        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  |        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â”†
  |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”†        â”†
  |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”†         â”†        â”†
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”†        â”†         â”†        â”†
~â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â”†        â”†        â”†         â”†        â”†
~â”€â•®        â”†        â”†        â”†        â”†         â”†        â”†
  â†“        â†“        â†“        â†“        â†“         â†“        â†“
[10  2  3 13  5  6  1  8  9  4 11 12  7 14 15][10  2  3 13...
     |        |        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
     |        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â”†
     |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”†        â”†
     |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”†         â”†        â”†
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”†        â”†         â”†        â”†
~â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â”†        â”†        â”†         â”†        â”†
~â”€â”€â”€â”€â•®        â”†        â”†        â”†        â”†         â”†        â”†
     â†“        â†“        â†“        â†“        â†“         â†“        â†“
[10 11  3 13 14  6  1  2  9  4  5 12  7  8 15][10 11  3 13 14...
        |        |        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
        |        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â”†
        |        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”†        â”†
        |        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”†         â”†        â”†
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”†        â”†         â”†        â”†
~â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â”†        â”†        â”†         â”†        â”†
~â”€â”€â”€â”€â”€â”€â”€â•®        â”†        â”†        â”†        â”†         â”†        â”†
        â†“        â†“        â†“        â†“        â†“         â†“        â†“
[10  . 12  .  . 15: .  .  3* .  .  6  .  .  9][ .  . 12  .  . 15...
```

## â–½ Triple reversal rotation

"This is an easy and reliable way to rotate in-place. You reverse the
left side, next you reverse the right side, next you reverse the entire
array. Upon completion the left and right block will be swapped. There's
no known first publication, but it was prior to *1981*."[^1]

### Example

```text
                           mid
       left = 9            |    right = 6
[ 1  2  3  4  5  6 :7  8  9*10 11 12 13 14 15]  // reverse left
  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“
[ 9  8  7  6  5  4  3  2  1 10 11 12 13 14 15]  // reverse right
                             â†“  â†“  â†“  â†“  â†“  â†“
[ 9  8  7  6  5  4  3  2  1 15 14 13 12 11 10]  // reverse all
  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“  â†“
[10 11 12 13 14 15 :1  2  3* 4  5  6  7  8  9]
```

## â†¬ Gries-Mills rotation

"In some cases this rotation outperforms the classic triple reversal rotation
while making fewer moves. You swap the smallest array linearly towards its
proper location, since the blocks behind it are in the proper location you
can forget about them. What remains of the larger array is now the smallest
array, which you rotate in a similar manner, until the smallest side shrinks
to `0` elements. Its first known publication was in *1981* by *David Gries* and
*Harlan Mills*."[^1]

### Example

```text
                 ğ‘ â„ğ‘ğ‘‘ğ‘œğ‘¤    mid
          left = 9         |    right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // swap r-side and shadow
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬\~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ 1  .  3 10  .  .  .  . 15  4 ~~~~~~~~~~~~ 9]

   l = 3     ğ‘ â„. r = 6
[ 1  .  3*10  . 12:13  . 15] 4  .  .  .  .  9   // swap new l-side and new shadow
  â””â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”¬~/â”¬â”€â”€â”€â”€â”€â”
[10 ~~ 12  1  .  3 13  . 15] 4  .  .  .  .  9

           l = 3    r = 3
 10 ~~ 12[ 1  .  3;13  . 15] 4  .  .  .  .  9   // swap equal
          â””â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”˜
          â”Œâ”€â”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”
 10 ~~ 12[13 ~~~ 15 1 ~~~ 3] 4  .  .  .  .  9

[10 ~~~~~~~~~~~ 15: 1 ~~~ 3* 4 ~~~~~~~~~~~~ 9]
```

## ğŸ† Grail (Gries-Mills + *swap_backward*) rotation

"The grail rotation from the Holy *Grail Sort Project*[^2] is *Gries-Mills* derived
and tries to improve locality by shifting memory either left or right depending on which
side it's swapped from.

In addition it performs an auxiliary rotation on stack memory when the smallest side reaches
a size of `1` element, which is the worst case for the *Gries-Mills rotation*. The flow diagram
is identical to that of *Gries-Mills*, but due to memory being shifted from the right the
visualization differs."[^1]

### Examples

```text
                 ğ‘ â„ğ‘ğ‘‘ğ‘œğ‘¤    mid
          left = 9         |    right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // swap r-side and shadow
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬\~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ 1  .  3 10  .  .  .  . 15  4 ~~~~~~~~~~~~ 9]

   l = 3     ğ‘ â„. r = 6
[ 1  .  3*10  . 12:13  . 15] 4  .  .  .  .  9   // swap new l-side and new shadow
  â””â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”¬~/â”¬â”€â”€â”€â”€â”€â”
[10 ~~ 12  1  .  3 13  . 15] 4  .  .  .  .  9

           l = 3    r = 3
 10 ~~ 12[ 1  .  3;13  . 15] 4  .  .  .  .  9   // swap equal
          â””â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”˜
          â”Œâ”€â”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”
 10 ~~ 12[13 ~~~ 15 1 ~~~ 3] 4  .  .  .  .  9

[10 ~~~~~~~~~~~ 15: 1 ~~~ 3* 4 ~~~~~~~~~~~~ 9]
```

## âŠ› Drill rotation

"The drill rotation is a grail variant that utilizes a piston main loop
and a helix inner loop. Performance is similar to the helix rotation.
The flow diagram and visualization are identical to the grail rotation."[^1]

*2021* - Drill rotation by *Igor van den Hoven* (*Grail* derived with *Piston*
and *Helix* loops).

### Examples

```text
                           mid
          left = 9         |     right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // swap
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬\~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ 1  .  3;10  . 12 13  . 15] 4 ~~~~~~~~~~~~ 9   // swap
  â””â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”
[ 10 ~~~~~~~~~~ 15: 1 ~~~ 3* 4  .  .  .  .  9]
```

## ğŸª  Successive aka Piston rotation

"First described by *Gries and Mills* in *1981*, this rotation is very similar to
the Gries-Mills rotation but performs non-linear swaps. It is implemented as
the *Piston Rotation* in the benchmark, named after a loop optimization that
removes up to `log n` branch mispredictions by performing both a left and
rightward rotation in each loop."[^1]

### Algorithm

1. Swap the smallest side to its place;
2. repeat with smaller array.

### Properties

* During computation `mid` is never shifted.

### Example

```text
                           mid
          left = 9         |   right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // swap
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€/\â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€~/â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[10 ~~~~~~~~~~~ 15: 7  .  9  1  .  .  .  .  6]

                      l = 3        r = 6
 10  .  .  .  . 15[ 7  .  9* 1  .  3: 4  .  6]  // swap
                    â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€/\â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
                    â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€\~â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
 10  .  .  .  . 15[ 4  .  6  1  .  3  7 ~~~ 9]

                      l = 3   r = 3
 10  .  .  .  . 15[ 4  .  6; 1  .  3] 7  .  9   // swap
                    â””â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”˜
                    â”Œâ”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”
 10  .  .  .  . 15[ 1 ~~~ 3  4 ~~~ 6] 7  .  9

[10  .  .  .  . 15: 1 ~~~ 3* 4 ~~~~~~~~~~~~ 9]
```

# ğŸ§¬ Helix rotation

"The helix rotation has similarities with the *Gries-Mills
rotation* but has a distinct sequential movement pattern. It is
an improvement upon the *Grail* rotation by merging the two inner
loops into a single loop, significantly improving performance when
the relative size difference between the two halves is large. In
addition it doesn't stop when the smallest block no longer fits,
but continues and recalculates the left or right side. The utilization
of the merged loops is counter-intuitive and is likely novel. Its
first known publication was in *2021* by *Control* from the *Holy Grail
Sort Project*[^2]."[^1]

## Examples

```text
                           mid
          left = 9         |    right = 6
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // swap
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬\~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ 1  .  3 10  . 12 13  . 15  4 ~~~~~~~~~~~~ 9]  // swap
  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€/\â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€\~â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
[13  . 15;10  . 12] 1 ~~~ 3  4  .  .  .  .  9   // swap
  â””â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”
[10 ~~ 12 13 ~~ 15] 1 ~~~~~~~~~~~~~~~~~~~~~ 9

[10 ~~~~~~~~~~~ 15: 1  .  3* 4  .  .  .  .  9]
```

```text
                        mid
         left = 8       |      right = 7
[ 1  2  3  4  5  6  7: 8* 9 10 11 12 13 14 15]  // swap
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬\~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[ 1  9 .............. 15  2 ~~~~~~~~~~~~~~~ 8]  // swap
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€/\â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€\~â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
[15; 9 10 11 12 13 14] 1 ~~~~~~~~~~~~~~~~~~ 8]  // aux rotate

[ 9 ~~~~~~~~~~~~~~ 15: 1* .  .  .  .  .  .  8]

```

## âŠ Contrev (Conjoined triple reversal) rotation

"The conjoined triple reversal is derived from the triple reversal rotation. Rather than three
separate reversals it conjoins the three reversals, improving locality and reducing
the number of moves. Its first known publication was in *2021* by *Igor van den
Hoven*."[^1]

*2021* - *Conjoined Triple Reversal rotation* by *Igor van den Hoven*.

### Examples

Case: `right > left`, `9 - 6`.

```text
                           mid
  ls-->               <--le|rs-->       <--re
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // (ls -> le -> re -> rs -> ls)
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®           â•°â”ˆâ”ˆâ”† â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
  â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ•¯â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â•¯
  â†“  ls               le  |   |rs       reâ”†
[10  2  .  .  .  .  .  8  1 15â•¯11 ..... 14â•°>9]  // (ls, le, re, rs)
     â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®        â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”ˆâ”ˆâ•¯ â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
     â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯  â•­â”€â”€â”€â”€â”€ â”†â•¯
     â†“  ls         le  |        | rs reâ”†
[10 11  3  .  .  .  7  2  1 15 14 12 13â•°>8  9]
        â•°â”€â”€â”€â”€â”€â•®     â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”† â•®|
        â•­â”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯â•­|â•¯
        â†“  ls   le  |             reâ”†
[10  . 12  4  .  6  3  2  1 15 14 13â•°>7  .  9]  // (ls, le, re)
           â•°â”€â”€â•®  â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”ˆâ”ˆâ•¯
           â•­â”ˆ â•°â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯â”†
           â†“  ls |             reâ”†
[10 ~~~~~ 13  5  4  3  2  1 15 14â•°>6 ~~~~~~ 9]  // (ls, re)
              â•°â”ˆâ”ˆâ•°â”ˆâ”ˆâ•°â”ˆâ•®â”†â•­â”ˆâ•¯â”ˆâ”ˆâ•¯â”ˆâ”ˆâ•¯
              â•­â”ˆâ”ˆâ•­â”ˆâ”ˆâ•­â”ˆâ•°â”†â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®
              â†“  â†“  â†“  â†“  â†“  â†“  â†“
[10  .  .  . 14 15: 1  2  3* 4  5  .  .  .  9]
```

Case: `left < right`, `6 - 9`.

```text
                  mid
  ls-->      <--le|rs-->                <--re
[ 1  2  3  4  5  6* 7  8  9:10 11 12 13 14 15]  // (re -> rs -> ls -> le -> re)
  | â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â”†â”ˆâ”ˆâ•¯           â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  â•°â”€â”† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®â•°â”ˆâ”ˆâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®
    â”†ls      le |   | rs                re  â†“
[ 7<â•¯2  .  .  5 â•°1 15  8  .  .  .  .  . 14  6]  // (re, rs, ls, le)
     | â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â”†â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯        â•­â”€â”€â”€â”€â”€â”€â”€â”€â•¯
     â•°â”€â”† â”€â”€â”€â•® â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®
       â”†lsle|          | rs          re  â†“ 
[ 7  8<â•¯3  4â•°~2  1 15 14  9  .  .  . 13  5  6]
        |â•­ â”†â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯        â•­â”€â”€â”€â”€â”€â•¯
        â•°â”†â•®â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”€â”€â”€â”€â”€â•¯ â”ˆâ”ˆâ”ˆâ”ˆâ•®
         â”†â”†ls             | rs    re  â†“ 
[ 7  .  9â•¯â•°3  2  1 15 14 13 10 11 12  4  .  6]  // (re, rs, ls)
           â•°â”ˆâ•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯  â•­â”€â”€â•¯
            â”†â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”€â”€â•¯ â”€â•®
            â”† ls             | re  â†“ 
[ 7 ~~~~~ 10â•¯ 2  1 15 14 13 12 11  3 ~~~~~~ 6]  // (re, ls)
              â•°â”ˆâ”ˆâ•°â”ˆâ”ˆâ•°â”ˆâ•®â”†â•­â”ˆâ•¯â”ˆâ”ˆâ•¯â”ˆâ”ˆâ•¯
              â•­â”ˆâ”ˆâ•­â”ˆâ”ˆâ•­â”ˆâ•°â”†â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®
              â†“  â†“  â†“  â†“  â†“  â†“  â†“
[ 7  .  .  . 11 12*13 14 15: 1  2  .  .  .  6]
```

Case: `left > right`, `8 - 7`.

```text
                        mid
  ls-->            <--le|rs-->          <--re
[ 1  2  3  4  5  6  7: 8* 9 10 11 12 13 14 15]  // (ls -> le -> re -> rs -> ls)
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â•°â”ˆâ”ˆâ”† â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
  â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ•¯â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â•¯
  â†“  ls             le |   |rs          reâ”†
[ 9  2  .  .  .  .  7  1 15â•¯10 11 12 13 14â•°>8]  // (ls, le, re, rs)
     â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®     â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”† â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
     â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯ â•­â”€â”€â”€â”€â”€â”€â”€ â”†â•¯
     â†“  ls      le  |         |rs    reâ”†
[ 9 10  3  .  .  6  2  1 15 14â•¯11 12 13â•°>7  8]  // (ls, le, re, rs)
        â•°â”€â”€â”€â”€â”€â•®  â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”† â”ˆâ”ˆâ•®|
        â•­â”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯â•­â”€ â”†â•¯
        â†“  lsle  |               |rsâ”†
[ 9  . 11  4  5â•® 3  2  1 15 14 13â•¯12â•°>6  .  8]  // (ls, le, rs)
           â•°â”€â”€â•®â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
           â•­â”ˆ |â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”†â•¯
           â†“  ls               reâ”†
[ 9 ~~~~~ 12  4  3  2  1 15 14 13â•°>5 ~~~~~~ 8]  // (ls, re)
              â•°â”ˆâ”ˆâ•°â”ˆâ”ˆâ•°â”ˆâ•®â”†â•­â”ˆâ•¯â”ˆâ”ˆâ•¯â”ˆâ”ˆâ•¯
              â•­â”ˆâ”ˆâ•­â”ˆâ”ˆâ•­â”ˆâ•°â”†â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®
              â†“  â†“  â†“  â†“  â†“  â†“  â†“
[ 9  .  .  . 13 14 15: 1* 2  3  4  .  .  .  8]
```

## Combined rotations

### ğŸ¤ Trinity (Conjoined triple reversal + Bridge) rotation

"The trinity rotation (aka conjoined triple reversal) is derived from the triple reversal
rotation. Rather than three separate reversals it conjoins the three reversals, improving
locality and reducing the number of moves. Optionally, if the overlap is smaller than
`32 * size_of(usize)`, it skips the trinity rotation and performs an auxiliary
or bridge rotation on stack memory. Its first known publication was in *2021* by *Igor van den Hoven*."
[^1]

2021 - Trinity rotation by Igor van den Hoven (Conjoined Triple Reversal + Bridge rotation)

#### Example

Case: `right > left`, `9 - 6`.

```text
                           mid
  ls-->               <--le|rs-->       <--re
[ 1  2  3  4  5  6: 7  8  9*10 11 12 13 14 15]  // (ls -> le -> re -> rs -> ls)
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®           â•°â”ˆâ”ˆâ”† â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
  â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ•¯â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â•¯
  â†“  ls               le  |   |rs       reâ”†
[10  2  .  .  .  .  .  8  1 15â•¯11 ..... 14â•°>9]  // (ls, le, re, rs)
     â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®        â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”ˆâ”ˆâ•¯ â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
     â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯  â•­â”€â”€â”€â”€â”€ â”†â•¯
     â†“  ls         le  |        | rs reâ”†
[10 11  3  .  .  .  7  2  1 15 14 12 13â•°>8  9]
        â•°â”€â”€â”€â”€â”€â•®     â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”† â•®|
        â•­â”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯â•­|â•¯
        â†“  ls   le  |             reâ”†
[10  . 12  4  .  6  3  2  1 15 14 13â•°>7  .  9]  // (ls, le, re)
           â•°â”€â”€â•®  â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”ˆâ”ˆâ•¯
           â•­â”ˆ â•°â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯â”†
           â†“  ls |             reâ”†
[10 ~~~~~ 13  5  4  3  2  1 15 14â•°>6 ~~~~~~ 9]  // (ls, re)
              â•°â”ˆâ”ˆâ•°â”ˆâ”ˆâ•°â”ˆâ•®â”†â•­â”ˆâ•¯â”ˆâ”ˆâ•¯â”ˆâ”ˆâ•¯
              â•­â”ˆâ”ˆâ•­â”ˆâ”ˆâ•­â”ˆâ•°â”†â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®
              â†“  â†“  â†“  â†“  â†“  â†“  â†“
[10  .  .  . 14 15: 1  2  3* 4  5  .  .  .  9]
```

Case: `left < right`, `6 - 9`.

```text
                  mid
  ls-->      <--le|rs-->                <--re
[ 1  2  3  4  5  6* 7  8  9:10 11 12 13 14 15]  // (re -> rs -> ls -> le -> re)
  | â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â”†â”ˆâ”ˆâ•¯           â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  â•°â”€â”† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®â•°â”ˆâ”ˆâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®
    â”†ls      le |   | rs                re  â†“
[ 7<â•¯2  .  .  5 â•°1 15  8  .  .  .  .  . 14  6]  // (re, rs, ls, le)
     | â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â”†â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯        â•­â”€â”€â”€â”€â”€â”€â”€â”€â•¯
     â•°â”€â”† â”€â”€â”€â•® â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®
       â”†lsle|          | rs          re  â†“ 
[ 7  8<â•¯3  4â•°~2  1 15 14  9  .  .  . 13  5  6]
        |â•­ â”†â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯        â•­â”€â”€â”€â”€â”€â•¯
        â•°â”†â•®â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”€â”€â”€â”€â”€â•¯ â”ˆâ”ˆâ”ˆâ”ˆâ•®
         â”†â”†ls             | rs    re  â†“ 
[ 7  .  9â•¯â•°3  2  1 15 14 13 10 11 12  4  .  6]  // (re, rs, ls)
           â•°â”ˆâ•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯  â•­â”€â”€â•¯
            â”†â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•­â”€â”€â•¯ â”€â•®
            â”† ls             | re  â†“ 
[ 7 ~~~~~ 10â•¯ 2  1 15 14 13 12 11  3 ~~~~~~ 6]  // (re, ls)
              â•°â”ˆâ”ˆâ•°â”ˆâ”ˆâ•°â”ˆâ•®â”†â•­â”ˆâ•¯â”ˆâ”ˆâ•¯â”ˆâ”ˆâ•¯
              â•­â”ˆâ”ˆâ•­â”ˆâ”ˆâ•­â”ˆâ•°â”†â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®
              â†“  â†“  â†“  â†“  â†“  â†“  â†“
[ 7  .  .  . 11 12*13 14 15: 1  2  .  .  .  6]
```

Case: `left > right`, `8 - 7`.

```text
                        mid
  ls-->            <--le|rs-->          <--re
[ 1  2  3  4  5  6  7: 8* 9 10 11 12 13 14 15]  // (ls -> le -> re -> rs -> ls)
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®        â•°â”ˆâ”ˆâ”† â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
  â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ•¯â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”†â•¯
  â†“  ls             le |   |rs          reâ”†
[ 9  2  .  .  .  .  7  1 15â•¯10 11 12 13 14â•°>8]  // (ls, le, re, rs)
     â•°â”€â”€â”€â”€â”€â”€â”€â”€â•®     â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”† â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
     â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â”€â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯ â•­â”€â”€â”€â”€â”€â”€â”€ â”†â•¯
     â†“  ls      le  |         |rs    reâ”†
[ 9 10  3  .  .  6  2  1 15 14â•¯11 12 13â•°>7  8]  // (ls, le, re, rs)
        â•°â”€â”€â”€â”€â”€â•®  â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”† â”ˆâ”ˆâ•®|
        â•­â”ˆâ”ˆâ”ˆâ”ˆ â•°â”€â”€â•®â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•¯â•­â”€ â”†â•¯
        â†“  lsle  |               |rsâ”†
[ 9  . 11  4  5â•® 3  2  1 15 14 13â•¯12â•°>6  .  8]  // (ls, le, rs)
           â•°â”€â”€â•®â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ•®|
           â•­â”ˆ |â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”†â•¯
           â†“  ls               reâ”†
[ 9 ~~~~~ 12  4  3  2  1 15 14 13â•°>5 ~~~~~~ 8]  // (ls, re)
              â•°â”ˆâ”ˆâ•°â”ˆâ”ˆâ•°â”ˆâ•®â”†â•­â”ˆâ•¯â”ˆâ”ˆâ•¯â”ˆâ”ˆâ•¯
              â•­â”ˆâ”ˆâ•­â”ˆâ”ˆâ•­â”ˆâ•°â”†â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®â”ˆâ”ˆâ•®
              â†“  â†“  â†“  â†“  â†“  â†“  â†“
[ 9  .  .  . 13 14 15: 1* 2  3  4  .  .  .  8]
```

### Å• Default (Stable) rotation

Combines juggler, auxiliary and piston rotations.

*Algorithm 1* is used for small values of `left + right` or for large `T`. The elements are moved
into their final positions one at a time starting at `mid - left` and advancing by `right` steps
modulo `left + right`, such that only one temporary is needed. Eventually, we arrive back at
`mid - left`. However, if `gcd(left + right, right)` is not 1, the above steps skipped over
elements. For example:

```text
left = 10, right = 6
the `^` indicates an element in its final place
6 7 8 9 10 11 12 13 14 15 . 0 1 2 3 4 5
after using one step of the above algorithm (The X will be overwritten at the end of the round,
and 12 is stored in a temporary):
X 7 8 9 10 11 6 13 14 15 . 0 1 2 3 4 5
               ^
after using another step (now 2 is in the temporary):
X 7 8 9 10 11 6 13 14 15 . 0 1 12 3 4 5
              ^                 ^
after the third step (the steps wrap around, and 8 is in the temporary):
X 7 2 9 10 11 6 13 14 15 . 0 1 12 3 4 5
    ^         ^                 ^
after 7 more steps, the round ends with the temporary 0 getting put in the X:
0 7 2 9 4 11 6 13 8 15 . 10 1 12 3 14 5
^   ^   ^    ^    ^       ^    ^    ^
```

Fortunately, the number of skipped over elements between finalized elements is always equal, so
we can just offset our starting position and do more rounds (the total number of rounds is the
`gcd(left + right, right)` value). The end result is that all elements are finalized once and
only once.

*Algorithm 2* is used if `left + right` is large but `min(left, right)` is small enough to
fit onto a stack buffer. The `min(left, right)` elements are copied onto the buffer, `memmove`
is applied to the others, and the ones on the buffer are moved back into the hole on the
opposite side of where they originated.

Algorithms that can be vectorized outperform the above once `left + right` becomes large enough.
*Algorithm 1* can be vectorized by chunking and performing many rounds at once, but there are too
few rounds on average until `left + right` is enormous, and the worst case of a single
round is always there. Instead, algorithm 3 utilizes repeated swapping of
`min(left, right)` elements until a smaller rotate problem is left.

```text
                                 mid
             left = 11           | right = 4
[ 5  6  7  8 :9 10 11 12 13 14 15* 1  2  3  4]  // swap
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
[ 5  .  .  .  .  . 11: 1 ~~~~~~ 4 12  .  . 15]

[ 5  .  7  1  .  .  4: 8  .  . 11 12 ~~~~~ 15   // swap
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”´/\â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬~~â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” 
[ 5  .  7  8 :9  . 11: 1 ~~~~~~ 4*12  .  . 15
we cannot swap any more, but a smaller rotation problem is left to solve
```

when `left < right` the swapping happens from the left instead.

## Benchmarks

To run benchmarks do:

```text
cargo bench
```

Result could be found in the `target/criterion/{name_of_the_benchmarks_group}/report`.

You would have to install `gnuplot` to get the pictures.

Note that benchmarking could take some time :)

[^1]: [https://github.com/scandum/rotate](https://github.com/scandum/rotate)

[^2]: [https://github.com/HolyGrailSortProject](https://github.com/HolyGrailSortProject)
